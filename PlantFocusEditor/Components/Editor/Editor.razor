@inject IJSRuntime JS;

<section class="editor">
    <EditorBar @ref="_editorBar" />
    <div id="konva-container" @onclick="OnKonvaClicked"  @ontouchend="OnKonvaClicked"></div>
    <button @onclick="Save">Save to pdf</button>
</section>

@code {
    [Parameter]
    public Action KonvaClicked { get; set; }

    private IJSObjectReference? _module;
    private EditorBar? _editorBar;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            _module = await JS.InvokeAsync<IJSObjectReference>("import", "./js/modules/saveToPdf.js");
        }
    }

    private void Save()
    {
        if (_module != null)
        {
            _module.InvokeVoidAsync("saveToPdfFromJson");
        }
    }

    private void OnKonvaClicked()
    {
        _editorBar?.getUndoRedoStates();
        InvokeAsync(KonvaClicked);
    }
}
